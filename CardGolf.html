<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Card Deal Layout (Real Deck)</title>
<style>
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  user-select: none;
  -webkit-tap-highlight-color: transparent;
}

body {
  background: #006600;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: flex-start;
  min-height: 100vh;
  margin: 0;
  color: #000;
  font-family: "Segoe UI", sans-serif;
  padding: 10px;
  gap: 10px;
}

/* Make everything clickable/touchable */
button, .card {
  cursor: pointer;
  touch-action: manipulation;
}
button {
  padding: 8px;
  font-size: clamp(15px, 3vw, 40px);
  color:#006600;
  background: rgb(195, 204, 212);
  border-radius: 26px;
  margin: 2vw;
}
button:hover {
  background: rgb(229, 236, 243);
}
#scoreboard, table, td, th {
  cursor: default;
}

/* Table Styling */
table, tr, th, td, caption {
  border: 1px solid black;
  border-collapse: collapse;
  text-align: center;
  padding: 8px;
  font-size: clamp(15px, 3vw, 40px);
}
.current-round {
box-shadow: 0 0 12px 4px #1bff00;
    border-color: #1bff00;
    background-color: rgba(27, 255, 0,.75);
  transition: box-shadow 0.3s ease, background-color 0.3s ease;
}
caption {
  font-size: 2rem;
  font-weight: bold;
  background: linear-gradient(135deg, #0044cc, #0077ff);
}
/* Main Game Area */
#cardTable {
  position: relative;
  height: auto;
  max-width: 1000px;
  margin: 0 auto;
  margin-bottom: 20px;
  display: flex;
  flex-direction: column;
  gap: 15px;
}

/* Stock & Waste Row */
#drawPile {
  display: flex;
  justify-content: space-between;
  align-items: center;
  width: 40vw;
  padding: 0 5%;
  gap: 5%;
}

#stack, #waste{
  position: relative;
  width: clamp(60px, 12vw, 100px);
  aspect-ratio: 7/10;
  border: 2px dashed rgba(255,255,255,0.3);
  border-radius: 8px;
  background: rgba(0,0,0,0.1);
}
#stack .card {
  position: absolute;
  width: 100%;
  height: 100%;
  top: 0;
  left: 0;
}

#stack { transform: none; }

/* Foundation Piles (optional) */
#foundations {
  display: flex;
  gap: 10px;
}
.foundation {
  width: clamp(60px, 12vw, 100px);
  height: clamp(80px, 16vw, 140px);
  border: 2px dashed rgba(255,255,255,0.3);
  border-radius: 8px;
  background: rgba(0,0,0,0.1);
}

/* Columns (Tableau) */
#columns {
  display: flex;
  justify-content: center;
  gap: clamp(8px, 2vw, 20px);
  width: 100%;
  padding: 0 2%;
}

.column {
  display: flex;
  flex-direction: column;
  align-items: center;
  position: relative;
  width: calc((90vw - (6 * 2vw)) / 7);
}

/* Card Styling */
.card {
  position: absolute;
  width: 100%;
  aspect-ratio: 7/10;
  border-radius: 8px;
  border: 1px solid #111;
  background-color: rgb(204, 204, 204);
  box-shadow: 0 2px 6px rgba(0,0,0,0.5);
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  padding: 6px;
  font-size: clamp(10px, 2.5vw, 18px);
  transition: transform 0.4s ease;
  z-index: 1;
}

.card.dragging {
  z-index: 1000;
  transform: rotate(5deg) scale(1.05);
  box-shadow: 0 10px 20px rgba(0,0,0,0.4);
}

/* Card Content */
.suit {
  font-size: clamp(30px, 8vw, 100px);
}
.rank {
  font-weight: bold;
  font-size: clamp(10px, 3.5vw, 26px);
  white-space: nowrap;
  overflow: hidden;
}
.red { color: red; }

/* Card Back */
.back {
  background: linear-gradient(135deg, #0044cc, #0077ff);
  border: 2px solid white;
  display: flex;
  justify-content: center;
  align-items: center;
  color: white;
  font-size: clamp(24px, 5vw, 40px);
  font-weight: bold;
}

/* Card Flip Animation */
.flip {
  transform: rotateY(180deg);
}

/* Overlapping Cards in Column */
.column .card {
  position: relative;
  margin-top: -95%;
}
.column .card:first-child {
  margin-top:0;
}

/* Counter (optional) */
.counter {
  font-size: clamp(32px, 8vw, 60px);
  color: rgba(0,0,0,.5);
  text-align: center;
}
#waste .card {
  position: absolute;
  width: 100%;
  height: 100%;
  top: 0;
  left: 0;
}
#waste .card .rank {
  font-size: clamp(18px, 3vw, 28px);
}
#waste .card .suit {
  font-size: clamp(24px, 7vw, 55px);
}
/* Responsive Adjustments */
@media (max-width: 600px) {
}

</style>
</head>
<body>
<body>
    <table id="scoreboard" >
        <tr>
            <caption>Golf Solitaire</caption>
        </tr>
        <tr>
            <th>1</th>
            <th>2</th>
            <th>3</th>
            <th>4</th>
            <th>5</th>
            <th>6</th>
            <th>7</th>
            <th>8</th>
            <th>9</th>
            <th>Total</th>
        </tr>
        <tr>
            <td id="round1"></td>
            <td id="round2"></td>
            <td id="round3"></td>
            <td id="round4"></td>
            <td id="round5"></td>
            <td id="round6"></td>
            <td id="round7"></td>
            <td id="round8"></td>
            <td id="round9"></td>
            <td id="total"></td>
        </tr>
    </table>

  <div id="cardTable">
    <div id="columns"></div>
  </div>
  <div id="drawPile">
    <div id="stack"></div>
    <div id="waste"></div>
    </div>
    
  <div id="menuButtons">
    <button id="newGameButton">New Game</button>
    <button id="nextRoundButton">Next Hole</button>
  </div>

  <script>
const suits = ['♠','♥','♦','♣'];
const ranks = ['A','2','3','4','5','6','7','8','9','10','J','Q','K'];
const rankOrder = ranks;

let deck = [];
let cardsLeft = 17;
const cols = 7;
const rows = 5;
const overlap = 30;
let currentRound = 0;
const maxRounds = 9;
let roundScores = Array(maxRounds).fill(0); // stores each round score
let totalScore = 0;


const columnsContainer = document.getElementById('columns');
const stackContainer = document.getElementById('stack');
const wasteContainer = document.getElementById('waste');

let currentWasteCard = null;

// Helper to check playable
function isPlayable(rank, wasteRank) {
  const i = rankOrder.indexOf(rank);
  const j = rankOrder.indexOf(wasteRank);
  return Math.abs(i-j) === 1 || Math.abs(i-j) === 12; // wrap A<->K
}

//Move Card to Waste Pile
function moveToWaste(cardElem, cardData) {
  if (cardElem.parentElement) cardElem.parentElement.removeChild(cardElem);

  // Reset any transforms or positions
  cardElem.style.transform = '';
  cardElem.style.top = '';
  cardElem.style.left = '';
  cardElem.style.position = ''; // will be overridden by CSS

  cardElem.classList.remove('back');
  cardElem.innerHTML = `
    <div class="rank">${cardData.rank} ${cardData.suit}</div>
    <div class="suit" style="text-align:center;">${cardData.suit}</div>
  `;

  wasteContainer.appendChild(cardElem);
  currentWasteCard = { rank: cardData.rank, suit: cardData.suit };
}

// New Deal function
function newDeal() {
  // Clear previous board
  columnsContainer.innerHTML = '';
  stackContainer.innerHTML = '';
  wasteContainer.innerHTML = '';
  currentWasteCard = null;
  cardsLeft = 17;
  updateScoreboard();

  // Build and shuffle deck
  deck = [];
  for (let s of suits) for (let r of ranks) deck.push({suit:s, rank:r});
  for (let i = deck.length -1; i>0; i--) {
    const j = Math.floor(Math.random()*(i+1));
    [deck[i], deck[j]] = [deck[j], deck[i]];
  }

  // Create columns
  const columns = [];
  for (let i=0; i<cols; i++) {
    const colDiv = document.createElement('div');
    colDiv.classList.add('column');
    columnsContainer.appendChild(colDiv);
    columns.push(colDiv);
  }

  // Deal cards to columns
  let cardIndex = 0;
  for (let col=0; col<cols; col++) {
    for (let row=0; row<rows; row++) {
      if (cardIndex >= deck.length) break;
      const cardData = deck[cardIndex++];
      const card = document.createElement('div');
      card.classList.add('card');
      if (cardData.suit==='♥' || cardData.suit==='♦') card.classList.add('red');

      card.dataset.rank = cardData.rank;
      card.dataset.suit = cardData.suit;

      card.innerHTML = `
        <div class="rank">${cardData.rank} ${cardData.suit}</div>
        <div class="suit" style="text-align:center;">${cardData.suit}</div>
      `;

      // Only top card clickable
      card.addEventListener('click', () => {
        const columnCards = Array.from(columns[col].children);
        if (columnCards[columnCards.length-1] !== card) return; // not top card
        if (!currentWasteCard) return;
        if (isPlayable(card.dataset.rank, currentWasteCard.rank)) {
          moveToWaste(card, cardData);
        }
      });

      columns[col].appendChild(card);
    }
  }

  // Remaining cards go to stack
  for (; cardIndex < deck.length; cardIndex++) {
    const card = document.createElement('div');
    card.classList.add('card','back');
    stackContainer.appendChild(card);
  }
}

function updateStackCounter() {
  const topCard = stackContainer.lastElementChild;
  if (!topCard) return;

  // Remove existing counter if any
  const oldCounter = topCard.querySelector('.counter');
  if (oldCounter) oldCounter.remove();

  // Add new counter
  const counterDiv = document.createElement('div');
  counterDiv.classList.add('counter');
  counterDiv.innerText = cardsLeft;
  topCard.appendChild(counterDiv);
}

// Initial display
updateStackCounter();
// Stack click to flip top card
stackContainer.addEventListener('click', () => {
  const topCard = stackContainer.lastElementChild;
  if (!topCard) return;

  const cardData = deck.pop();
  if (!cardData) return;

  moveToWaste(topCard, cardData);

  cardsLeft -=1;
  updateStackCounter();
});

// Function to calculate score 
function calculateRoundScore() {
  let score = 0
  score = 52-(wasteContainer.children.length+(2*cardsLeft)); // count all remaining cards
  return score;
}

// Function to place scores in chart
function updateScoreboard() {
  const scoreboard = document.getElementById('scoreboard');
  const scoreCells = document.querySelectorAll("#scoreboard td");

  
  // 10 round cells

for (let i = 0; i < maxRounds; i++) {
    scoreCells[i].innerText = roundScores[i] ? roundScores[i] : '-';
}

  
// total cell 
totalScore = roundScores.reduce((a,b) => a+b, 0); 
scoreCells[9].innerText = totalScore;
}

// Function to highlight Round number in table
function highlightCurrentRound() {
  const roundCells = document.querySelectorAll("#scoreboard th")
  const scoreCells = document.querySelectorAll("#scoreboard td");
  roundCells.forEach((cell, index) => {
    if (index === currentRound) {
      cell.classList.add("current-round");
    } else {
      cell.classList.remove("current-round");
    }
  });
}

// Next Round Button and update score and round
document.getElementById('nextRoundButton').addEventListener('click', () => {
  if (currentRound >= maxRounds) return; // already finished
  
  const score = calculateRoundScore();
  roundScores[currentRound] = score;
  updateScoreboard();
    currentRound++;
  highlightCurrentRound();
  

  newDeal(); // start next round
});



// Bind New Game button and reset score and rounds
document.getElementById('newGameButton').addEventListener('click', () => {
if (window.confirm("Are you sure you want to restart the game?")) {
  // user clicked "OK" (Yes)
  newGame();
} else {
  // user clicked "Cancel"
  console.log("Canceled.");
}
});

function newGame() {
  currentRound = 0;
  roundScores = Array(maxRounds).fill(0);
  totalScore = 0;
  updateScoreboard();
  newDeal();
  highlightCurrentRound();
}

// Function to lock Card Table height
function lockCardTableHeight() {
  const table = document.getElementById('cardTable');
  table.style.height = table.scrollHeight + 'px';
}

// Initial deal
newDeal();
highlightCurrentRound();
lockCardTableHeight();
  </script>
</body>
</html>
